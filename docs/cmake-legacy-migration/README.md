Reference Docs Naming Convention
=============================

This folder groups the reference migration documents in a predictable order so
both humans and tooling can find the right reference quickly.

Start here: `00-INDEX.md`.

Naming Scheme
-------------
- 00-INDEX.md: entry point and routing
- 10-PLAN.md: acceptance criteria and checklist
- 20-RUNBOOK.md: step-by-step validation procedure
- 30-REFERENCE.md: canonical reference install contract
- 40-STATUS.md: current status snapshot
- STATUS-HISTORY.md: detailed run history and notes
- refs/${BUILD_TOOL}.${OS}.${VARIANT}/ref: versioned reference list used by CI (Linux server, clients, BSD systems)
- refs/${BUILD_TOOL}.${OS}.${VARIANT}/keyfiles.sha256: corresponding keyfile checksums

CI now also stages `docs/refs/${BUILD_TOOL}.${OS}.${VARIANT}/` for each build tool (e.g. `make`, `cmake`). That folder mirrors the legacy artifacts (plain `ref`, `config.h`, `keyfiles.sha256`, `perms`, `symlinks`, `binlinks`, `embedded.paths`) and adds a tarball (`${BUILD_TOOL}.${OS}.${VARIANT}.tar.gz`) suitable for uploading.
During CI runs these files are first copied into `/tmp/xymon-refs/${BUILD_TOOL}.${OS}.${VARIANT}` before landing in `docs/refs/...`, so you can inspect `/tmp/xymon-refs` to verify the staged refs before the archive is produced.

Guidelines
----------
- Keep one source of truth per topic.
- Update `40-STATUS.md` after any significant change or validation run.
- Append run details to `STATUS-HISTORY.md` when needed.
- Track changes in `STATUS-HISTORY.md`.
- Treat all `refs/${BUILD_TOOL}.${OS}.${VARIANT}/ref` and `keyfiles.sha256` files as read-only. Do not edit them by hand.
- References are generated by:
- `.github/workflows/ref_make_<os>.yml`
  - `ci/legacy-reference.sh`
- `.github/workflows/ref-sync.yml` collects artifacts and writes them to `origin/ci/update-legacy-references`.
- Manually merge `origin/ci/update-legacy-references` into your code branch after reviewing the changes.

Generating `legacy.linux.server.ref`
-----------------------
Use this only when legacy Makefiles change.
Follow the exact commands in `20-RUNBOOK.md`.

BSD references follow the same procedure, replacing the output path:
- `legacy.freebsd.ref`
- `legacy.openbsd.ref`
- `legacy.netbsd.ref`

CI workflows
------------
Legacy references are generated via the per-OS workflows:
- `.github/workflows/ref_make_linux.yml`
- `.github/workflows/ref_make_freebsd.yml`
- `.github/workflows/ref_make_openbsd.yml`
- `.github/workflows/ref_make_netbsd.yml`
